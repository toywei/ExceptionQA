Q

我写的程序常常出现“段错误(segment fault)”或者“非法操作，该内存地址不能read/write”的错误信息，这是怎么回事？

A

这是典型的非法指针解引用造成的错误。当指针指向一个不允许读或写的内存地址，而程序却试图用指针来读或写该地址的时候，就会出现这个错误。

在Linux或Winodws的内存布局中，有些地址是始终不能读写的，例如0地址。还有一些地址是一开始不允许读写，应用程序必须事先请求获取这些地址的读写权，或者某些地址一开始并没有映射到实际的物理内存，应用程序鼻血事先请求这些地址映射到实际的物理地址(commit)，之后才能够自由地读写这片内存。

当指针指向这些区域的时候，对它指向的内存进行读写就会引发错误。

造成这样的最普遍的原因有两种：

1、程序员将指针初始化为NULL，之后却没有给它一个合理的值就开始使用指针。

2、程序员没有初始化栈上的指针，指针的值一般会是随机数，之后就直接开始使用指针。

因此，如果你的程序出现了这样的错误，请着重检查指针的使用情况。


referrer

《程序员的自我修养 : 链接、装载与库》